<div class="user-profile">
  <mat-card style="background-color: #ec8b0d;">
    <mat-card-header>
      <div mat-card-avatar class="profile-image">
        <img *ngIf="account?.profilePicture" [src]="account?.profilePicture" [alt]="'profile image of ' + account?.name" />
        <img *ngIf="!account?.profilePicture" src="../../assets/1511304664.png" [alt]="'profile image of ' + account?.name + ', but it seems to not be working properly...'" />
      </div>
      <mat-card-title style="color: white;"><h1><b>{{ account?.name }}</b></h1></mat-card-title>
      <br>
      <mat-card-subtitle>
        <p style="color: white;">@{{ account?.username }}</p>
      </mat-card-subtitle>
    </mat-card-header>
    <mat-card-content *ngIf="account?.followers && account?.following">
      <p><mat-icon>people_outline</mat-icon>&nbsp; <b>Followers:</b> {{ account?.followers?.length }}</p>
      <p><mat-icon>people</mat-icon>&nbsp; <b>Following:</b> {{ account?.following?.length }}</p>
      <p><mat-icon>cake</mat-icon>&nbsp; <b>Joined:</b> {{ formatDate(account?.createdAt) }}</p>
      <p><b>Daily Characters:</b> {{ account?.dailyCharacters }}</p>
      <p><b>Weekly Characters:</b> {{ account?.weeklyCharacters }}</p>
      <p><b>Monthly Characters:</b> {{ account?.monthlyCharacters }}</p>
      <input type="file" class="file-input" (change)="onFileSelected($event)" #fileUpload>
      <div class="file-upload">
        {{fileName || "No file uploaded yet."}}
        <button *ngIf="un === account?.username" mat-mini-fab (click)="fileUpload.click()" style="background-color: #ebcc67;" alt="Image change button">
          <mat-icon>attach_file</mat-icon>
        </button>
      </div>
      <button *ngIf="un !== account?.username && !isFollowed" mat-raised-button (click)="follow()" style="background-color: #ebcc67;" alt="Button to follow user">Follow user</button>
      <button *ngIf="un !== account?.username && isFollowed" mat-raised-button (click)="unfollow()" style="background-color: #ebcc67;" lt="Button to unfollow user">Unfollow user</button>
    </mat-card-content>
   </mat-card>

  <mat-tab-group mat-stretch-tabs [backgroundColor]="'primary'">
    <mat-tab label="Recent Posts" aria-label="primary">
      <div class="post-list">
        <div class="post" *ngFor="let post of recentPosts">
          <mat-card id="squeal">
            <mat-card-header>
              <div mat-card-avatar class="profile-image">
                <img *ngIf="account?.profilePicture" [src]="account?.profilePicture" [alt]="'profile image of ' + account?.name" />
                <img *ngIf="!account?.profilePicture" src="../../assets/1511304664.png" [alt]="'profile image of ' + account?.name + ', but it seems to not be working properly...'" />
              </div>
              <mat-card-title class="squealTitle">@{{ post.author }}</mat-card-title>
              <br>
              <mat-card-subtitle class="squealText">{{ formatDate(post.date) }}</mat-card-subtitle>
            </mat-card-header>
            <mat-card-content>
              <h2 class="squealText">{{ post.body }}</h2>
            </mat-card-content>
          </mat-card>
        </div>
      </div>
    </mat-tab>

    <mat-tab label="Tagged Answers" aria-label="primary">
      <div class="answer-list">
        <div  *ngFor="let answer of taggedPosts">
          <div class="answer" *ngIf="answer.recipients.includes('@'+ userName)">
            <mat-card id="squeal">
              <mat-card-header>
                <div mat-card-avatar class="profile-image">
                  <div  *ngFor="let user of users">
                    <img *ngIf="answer?.author === user.username && user.profilePicture" [src]="user?.profilePicture" [alt]="'profile image of ' + answer?.author" />
                    <img *ngIf="answer?.author === user.username && !user.profilePicture" src="../../assets/1511304664.png" [alt]="'profile image of ' + answer?.author + ', but it seems to not be working properly...'" />
                  </div>
                </div>
                <mat-card-title class="squealTitle">@{{ answer.author }}</mat-card-title>
                <br>
                <mat-card-subtitle class="squealText">{{ formatDate(answer.date) }}</mat-card-subtitle>
              </mat-card-header>
              <mat-card-content>
                <h2 class="squealText">{{ answer.body }}</h2>
              </mat-card-content>
            </mat-card>
          </div>
        </div>
      </div>
    </mat-tab>
  </mat-tab-group>
</div>
